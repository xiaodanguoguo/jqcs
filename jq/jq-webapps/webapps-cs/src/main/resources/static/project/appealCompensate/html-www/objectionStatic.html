@@include('../../commonNav/html/commonHeaderBlue.html')
<style>
    .objectionStatic{
        width: 968px;margin: 10px;
        overflow-x: scroll;
        border: 1px solid #dee3e6;
    }
    .objSta-table{
        width: 6000px;
        table-layout: fixed;
    }
    .serachbox{
        margin: 20px 10px 50px 10px;
        width: 968px;
    }
    .serachbox-list{
        float: left;
        margin-bottom: 5px;
    }
    .serachbox-title{
        width: 90px;
        text-align: right;
        margin-right: 3px;
        height: 28px;
        line-height: 28px;
    }
    .serachbox-input{
        width: 120px;
    }
    .chosen-container{
        margin-left: 0;
        width: 142px!important;
    }
    .table-list-currentrow-tdetail{
        word-break: break-all;
        text-align: center;
    }
</style>
<ul class="serachbox" id="searchBox">
    <li class="serachbox-list">
        <span class="serachbox-title fl">质量投诉编号：</span>
        <input id="condclaimNo" type="text" class="serachbox-input fl inputBase">
    </li>
    <li class="serachbox-list" style="margin-top: 4px;height: 24px;">
        <span class="serachbox-title fl">异议状态：</span>
        <select id="condclaimState" name="" class="inputBase submission-box-list__Select">
            <option value="">请选择</option>
            <!--<option value="NEW">新建</option>-->
            <option value="PRESENT">已提报</option>
            <option value="ADOPT">销售审核通过</option>
            <option value="ACCEPTANCE">已受理</option>
            <option value="REJECT">已驳回</option>
            <option value="INVESTIGATION">调查中</option>
            <option value="HANDLE">处理中</option>
            <option value="END">已结案</option>
            <option value="EVALUATE">已评价</option>
        </select>
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">生产单位：</span>
        <select type="text" class="inputBase" id="conddeptCode">
            <option value="">请选择</option>
            <option value="2000">炼轧</option>
            <option value="1000">不锈</option>
            <option value="3000">榆钢</option>
            <option value="2200">碳钢</option>
        </select>
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">投诉客户：</span>
        <input type="text" class="serachbox-input fl inputBase" id="customerName">
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">提报时间：</span>
        <input class="inputBase serachbox-input" type="text" name="condstartDt" id="condstartDt" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'#F{$dp.$D(\'condendDt\')}'})" />
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">至：</span>
        <input class="inputBase serachbox-input" type="text" name="condendDt" id="condendDt" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'condstartDt\')}'})" />
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">产品大类：</span>
        <select id="condsid" name="" class="inputBase submission-box-list__Select" comType="" selCode="sid" selValue="typeName" emptyValue="请选择">
        </select>
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">产品名称：</span>
        <input type="text" class="serachbox-input fl inputBase" id="condzcpmc">
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">牌号：</span>
        <input type="text" class="serachbox-input fl inputBase" id="conddesignation">
    </li>
    <li class="serachbox-list">
        <span class="serachbox-title fl">缺陷名称：</span>
        <input type="text" class="serachbox-input fl inputBase" id="conddefectName">
    </li>
    <li class="serachbox-list fr" style="margin-right: 0">
        <div class="btnBaseCommon" comType="searchBtnCtrl" cond="condclaimNo,condclaimState,conddeptCode,customerName,condstartDt,condendDt,condsid,conddesignation,condzcpmc,conddefectName" rule="cond" unionTableId="tableList" parentId="searchBox">搜索</div>
        <div class="btnBaseCommon" id="export">导出</div>
    </li>
</ul>
<div class="objectionStatic">
    <table class="objSta-table table-list" id="tableList" comType="standardTableCtrl" templateId="templateRow" page="tcdPageCode" idx="indexNum" reqPath="/objectionLendger/findLedgerByPage" reqParam="{}" method="POST" noData="nonData" idx="indexNum">
        <tr class="table-list-currentrow">
            <th class="table-list-currentrow-theader" style="width:1%">序号</th>
            <th class="table-list-currentrow-theader" style="width: 2%">质量投诉编号</th>
            <th class="table-list-currentrow-theader" style="width: 1%">异议状态</th>
            <th class="table-list-currentrow-theader" style="width: 3%">使用客户</th>
            <th class="table-list-currentrow-theader" style="width: 1%">联系人</th>
            <th class="table-list-currentrow-theader" style="width: 2%">联系电话</th>
            <th class="table-list-currentrow-theader" style="width: 3%">代理公司（或酒钢驻外公司）</th>
            <th class="table-list-currentrow-theader" style="width: 1%">联系人</th>
            <th class="table-list-currentrow-theader" style="width: 2%">联系电话</th>
            <th class="table-list-currentrow-theader" style="width: 6%">物流过程</th>
            <th class="table-list-currentrow-theader" style="width: 3%">货物存放地</th>
            <th class="table-list-currentrow-theader" style="width: 6%">加工工艺</th>
            <th class="table-list-currentrow-theader" style="width: 3%">用途</th>
            <th class="table-list-currentrow-theader" style="width: 1%">车号</th>
            <th class="table-list-currentrow-theader" style="width: 2%">质证书编号</th>
            <th class="table-list-currentrow-theader" style="width: 1%">规格</th>
            <th class="table-list-currentrow-theader" style="width: 1%">牌号(mm)</th>
            <th class="table-list-currentrow-theader" style="width: 1%">提出异议量(t)</th>
            <th class="table-list-currentrow-theader" style="width: 1%">确认量(t)</th>
            <th class="table-list-currentrow-theader" style="width: 1%">赔偿金额（元）</th>
            <th class="table-list-currentrow-theader" style="width: 2%">投诉原因</th>
            <th class="table-list-currentrow-theader" style="width: 5%">确认的产品质量问题</th>
            <th class="table-list-currentrow-theader" style="width: 1%">异议类别</th>
            <th class="table-list-currentrow-theader" style="width: 1%">生产日期</th>
            <th class="table-list-currentrow-theader" style="width: 1%">生产工序</th>
            <th class="table-list-currentrow-theader" style="width: 6%">处理依据及处理方式</th>
            <th class="table-list-currentrow-theader" style="width: 1%">受理日期</th>
            <th class="table-list-currentrow-theader" style="width: 1%">到达时间</th>
            <th class="table-list-currentrow-theader" style="width: 1%">结案日期</th>
            <th class="table-list-currentrow-theader" style="width: 1%">结案人</th>
            <th class="table-list-currentrow-theader" style="width: 1%">处理周期</th>
            <th class="table-list-currentrow-theader" style="width: 8%">备注</th>
            <th class="table-list-currentrow-theader" style="width: 5%">客户评价</th>
        </tr>
        <tr class="table-list-currentrow" id="templateRow" style="display: none;">
            <td class="table-list-currentrow-tdetail" id="indexNum"></td>
            <td class="table-list-currentrow-tdetail" id="claimNo"></td>
            <td class="table-list-currentrow-tdetail" id="claimStateA"></td>
            <td class="table-list-currentrow-tdetail" id="lastUser"></td>
            <td class="table-list-currentrow-tdetail" id="createEmpNo"></td>
            <td class="table-list-currentrow-tdetail" id="lastUserTel"></td>
            <td class="table-list-currentrow-tdetail" id="customerName"></td>
            <td class="table-list-currentrow-tdetail" id="custEmpNo"></td>
            <td class="table-list-currentrow-tdetail" id="custTel"></td>
            <td class="table-list-currentrow-tdetail" id="logisticsProcess"></td>
            <td class="table-list-currentrow-tdetail" id="lastUserAddr"></td>
            <td class="table-list-currentrow-tdetail" id="endProcessingTech"></td>
            <td class="table-list-currentrow-tdetail" id="used"></td>
            <td class="table-list-currentrow-tdetail" id="originalCarNo"></td>
            <td class="table-list-currentrow-tdetail" id="millSheetNo"></td>
            <td class="table-list-currentrow-tdetail" id="specs"></td>
            <td class="table-list-currentrow-tdetail" id="designation"></td>
            <td class="table-list-currentrow-tdetail" id="objectionNum"></td>
            <td class="table-list-currentrow-tdetail" id="objectionConfirmation"></td>
            <td class="table-list-currentrow-tdetail" id="agreementAmount"></td>
            <td class="table-list-currentrow-tdetail" id="claimReason"></td>
            <td class="table-list-currentrow-tdetail" id="proProblem"></td>
            <td class="table-list-currentrow-tdetail" id="claimTypeA"></td>
            <td class="table-list-currentrow-tdetail" id="productDt"></td>
            <td class="table-list-currentrow-tdetail" id="millLine"></td>
            <td class="table-list-currentrow-tdetail" id="handingSuggestion"></td>
            <td class="table-list-currentrow-tdetail" id="admissibilityTime"></td>
            <td class="table-list-currentrow-tdetail" id="arrivalTime"></td>
            <td class="table-list-currentrow-tdetail" id="closingTime"></td>
            <td class="table-list-currentrow-tdetail" id="closingUser"></td>
            <td class="table-list-currentrow-tdetail" id="cycle"></td>
            <td class="table-list-currentrow-tdetail" id="memo"></td>
            <td class="table-list-currentrow-tdetail" id="evaluate"></td>
        </tr>
        <tr class="table-list-currentrow">
            <td class="table-list-currentrow-tdetail" id="indexNum" colspan="33">
                <div class="clearfix" style="width: 950px;padding-right: 20px">
                    <span class="fr" style="margin-right: 10px;" id="agreementAmountCount"></span>
                    <span class="fr" style="margin-right: 5px;">赔偿金额:</span>
                    <span class="fr" style="margin-right: 10px;" id="objectionConfirmationCount"></span>
                    <span class="fr" style="margin-right: 5px;">确认量总数:</span>
                    <span class="fr" style="margin-right: 10px;" id="objectionNumCount"></span>
                    <span class="fr" style="margin-right: 5px;">异议量总数:</span>
                </div>
            </td>
        </tr>
    </table>
    <div id="nonData" class="noDataCon" style="display: none">
        <i></i>
        <p>暂无数据......</p>
    </div>
</div>
<div class="tcdPageCode"></div>
<script>
    var jsonExprot = {};
    function clsStandardTableCtrl$progress(jsonItem, cloneRow) {
        //判断异议状态  0新建 1已提报  2已受理  3已驳回  4调查中  5处理中  6已结案  7已评价
        switch (jsonItem.claimState){
            case "NEW":
                $(cloneRow).find("#claimStateA").html("新建");
                break;
            case "PRESENT":
                $(cloneRow).find("#claimStateA").html("已提报");
                break;
            case "ADOPT":
                $(cloneRow).find("#claimStateA").html("销售审核通过");
                break;
            case "ACCEPTANCE":
                $(cloneRow).find("#claimStateA").html("已受理");
                break;
            case "REJECT":
                $(cloneRow).find("#claimStateA").html("已驳回");
                break;
            case "INVESTIGATION":
                $(cloneRow).find("#claimStateA").html("调查中");
                break;
            case "HANDLE":
                $(cloneRow).find("#claimStateA").html("处理中");
                break;
            case "END":
                $(cloneRow).find("#claimStateA").html("已结案");
                break;
            case "EVALUATE":
                $(cloneRow).find("#claimStateA").html("已评价");
                break;
        }
        switch (jsonItem.claimType) {
            case "1":
                $(cloneRow).find("#claimTypeA").html("表面外观");
                break;
            case "2":
                $(cloneRow).find("#claimTypeA").html("理化性能");
                break;
            case "3":
                $(cloneRow).find("#claimTypeA").html("加工使用");
                break;
            case "4":
                $(cloneRow).find("#claimTypeA").html("尺寸公差");
                break;
            case "5":
                $(cloneRow).find("#claimTypeA").html("实物不符");
                break;
            case "6":
                $(cloneRow).find("#claimTypeA").html("计量");
                break;
            case "7":
                $(cloneRow).find("#claimTypeA").html("其他");
                break;
            case "7":
                $(cloneRow).find("#claimTypeA").html("已评价");
                break;
        }
        //
        $("#agreementAmountCount").html(jsonItem.agreementAmountCount);
        $("#objectionConfirmationCount").html(jsonItem.objectionConfirmationCount);
        $("#objectionNumCount").html(jsonItem.objectionNumCount);
    }
    $(function(){
        limitCodeDeal($("*[limitCode]"),"limitCode");
        $("#condclaimState").chosen({
            no_results_text: "暂无结果",
            width: "142PX",
            enable_split_word_search: false,
            placeholder_text_single: ""
        });
        $("#conddeptCode").chosen({
            no_results_text: "暂无结果",
            width: "142PX",
            enable_split_word_search: false,
            placeholder_text_single: ""
        });
        initplugPath($("#condsid")[0],"singleSelectCtrl","/md/findItemsByTypeId",{"typeId": "MILL_BIG_TYPE"},"POST");
        $("#export").on("click",function(){
            var importParam = "name=" + JSON.stringify(jsonExprot);
            $.download(requestUrl + "/objectionLendger/export", importParam, "POST");
        });
    });

    function clsSearchBtnCtrl$after(jsonCond) {
        jsonExprot = jsonCond;
        return jsonCond;
    }

    //未知数组，已有接口，初始化插件;
    function initplugPath(docm,comType,reqPath,reqParam,reqMethod){
        if(reqPath != null){
            $(docm).attr("reqPath",reqPath);
        }
        if(reqParam != null){
            $(docm).attr("reqParam",JSON.stringify(reqParam));
        }
        if(reqMethod != null){
            $(docm).attr("reqMethod",reqMethod);
        }
        $(docm).attr("comType",comType);
        document.body.jsCtrl.ctrl = docm;
        document.body.jsCtrl.init();
    }

</script>


@@include('../../commonNav/html/commonFoot.html')